version: 2
jobs:
  ci:
    working_directory: ~/app
    docker:
      - image: circleci/node:7.10

    steps:
      - checkout

      - run:
          name: Install Dependencies
          command: npm install

#      - run:
#          name: Unit Tests
#          command: npm test

      - add-ssh-keys:
          fingerprints:
            - "89:b6:4e:b3:e7:7a:0b:b4:82:02:a3:e0:34:ce:0e:8d"

      - deploy:
          command: |
            if [ "${CIRCLE_BRANCH}" == "master" ];
              then ./build/publish.sh staging;
            fi

workflows:
  version: 2
  ci:
    jobs:
      - ci
          filters: 
            branches:
              only: master
